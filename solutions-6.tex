\newcommand{\sheet}{6}
\input{Header.tex}

\begin{document}

\maketitle{}

\begin{exercise}{1}
    \begin{enumerate}
        \item By the universal property of the fiber product of locally ringed spaces,
        we have the following commutative diagram
        \begin{center}
            \begin{tikzcd}
                U_i\times_{S_{i,j}}V_j\arrow[dotted]{dr}\arrow[bend right]{ddr}{p}\arrow[bend left]{rrd}{q}\\
                &X \times_S Y \arrow{r}{\pi_2}\arrow{d}{\pi_1} & V_j\arrow{d}{\psi}\\
                &U_i \arrow{r}{\phi} & S_{i,j}
            \end{tikzcd}
        \end{center}
        Therefore, on the level of sets,
        \begin{align*}
            U_i\times_{S_{i,j}}V_j \subset X \times_S Y,
        \end{align*}
        but in exercise 5.2.1, we showed that this induces 
        an open immersion as locally ringed spaces.

        Now observe that 
        \begin{center}
            \begin{tikzcd}
               &\bigcup_{i,j}\left(U_i\times_{S_{i,j}}V_j\right)\arrow{r}\arrow{d} & Y\arrow{d}\\
                &X \arrow{r} & S
            \end{tikzcd}
        \end{center}
        commutes, because $S=\bigcup_{i,j}S_{i,j}$.
        Now by uniqueness of the pullback, 
        \begin{align*}
           \bigcup_{i,j}\left(U_i\times_{S_{i,j}}V_j\right)\cong U_i\times_{S_{i,j}}V_j.
        \end{align*}

        I guess this is a good step in the direction of understanding
        why the pullback in the category of sheaves exists, right? If 
        we assume $X, Y, S$ to be sheaves and $U_i, V_j, S_{i,j}$ to be
        affine schemes, then by the above argument we found a cover
        of $X\times_S Y$ by affine schemes.
        \item Surjectivity follows, because a pullback of schemes
        in partiular makes
        \begin{center}
            \begin{tikzcd}
                &\mid X\times_S Y\mid \arrow{r}\arrow{d} & \mid X \mid\arrow{d}{\psi}\\
                &\mid Y\mid \arrow{r}{\phi} & \mid S \mid
            \end{tikzcd}
        \end{center}
        commute for all $\psi, \phi$ from maps of schemes.
    \end{enumerate}
\end{exercise}

\begin{exercise}{2}
    %TODO add remark about previous exercise
    \begin{enumerate}
        \item{
            First let $f \colon X \rightarrow S$ be open immersion. In this case
            we can directly use previous exercise on the following fibred
            product
                      
            \begin{center}
            \begin{tikzcd}
                &S \arrow{r}{\id} &S \\
                &S \times_S S' \arrow{r}{q} \arrow{u}{p} &S' \arrow{u}{g}
            \end{tikzcd}
            \end{center}

            by taking subset of $X \subseteq S$ and immediately getting open
            immersion $X \times_S S' \rightarrow S \times_S S'$, which we
            postcompose with canonical isomorphism $S \times_S S' \rightarrow
            S'$ and get that $X \times_S S' \rightarrow S'$ is open immersion.

            Now suppose $f \colon X \rightarrow S$ is a closed immersion. So we
            have the following diagram

            \begin{center}
            \begin{tikzcd}
                &X \arrow{r}{f} &S \\
                &X \times_S S' \arrow{r}{q} \arrow{u}{p} &S' \arrow{u}{g}
            \end{tikzcd}
            \end{center}

            We want to show $X \times_S S' \rightarrow S'$ is also a closed
            immersion. For that it satisfies to find an open covering of $S'$
            with affine subschemes such that preimages with be also affine schemes
            and induced maps of rings surjective.

            Take $s \in S'$ and a neighborhood $g(s) \in \Spec(R) = U \subseteq
            S$. Preimage $f^{-1}(U) = \Spec(A)$ already is affine, since $f$ is
            closed immersion, and for $g^{-1}(U)$ we have to take some smaller
            affine neighborhood of $s$. So we get $s \in \Spec(B) \subseteq
            g^{-1}(U)$. Then use previous exercise on these open sets and obtain
            open immersion
            \begin{equation*}
                \Spec(A) \times_{\Spec(R)} \Spec(B) = \Spec(A \otimes_R B)
                \rightarrow X \times_S S'.
            \end{equation*}
            By remark at the start we have
            \begin{equation*}
                \Spec(A \otimes_R B) = p^{-1}(\Spec(A)) \cap q^{-1}(\Spec(B)) =
                q^{-1}(\Spec(B)).
            \end{equation*}
            Only thing to argue is why the map $B \rightarrow A \otimes_R B$ is
            surjective. We have the following diagram

            \begin{center}
            \begin{tikzcd}
                &R \arrow{d} \arrow[twoheadrightarrow]{r} &A \arrow{d} \\
                &B \arrow{r} &A \otimes_R B
            \end{tikzcd}
            \end{center}

            Clearly bottom arrow is also surjective, which we can check by
            explicit computation.
            }
        \item{}
    \end{enumerate}
\end{exercise}

\begin{exercise}{3}
    By definition we have to compute a fibred product of $\Spec(B) \to \Spec(A)$
    and $\Spec(k(p)) \to \Spec(A)$ (where $k(p)$ is the residue field of $p \in
    \Spec(A)$ and $\to$ is the canonical inclusion). Since we are dealing with
    affine schemes, we can express it concretely as $\Spec(B \otimes_A k(p))$.
    Note that $B$ has the structure of an $A$-algebra, which is induced
    by the starting morphism of schemes $\Spec(B) \rightarrow \Spec(A)$.
    So this exercise reduces to computing these tensor products.
    
    We also observe that $k[T]$ is a PID, which means every non-zero prime ideal
    is a maximal ideal. This will be handy when computing residue fields,
    because after quotienting with a non-zero ideal we already get a field (we do
    not have to further take the quotient field).

    \begin{enumerate}
        \item{In the first example we do now even have to calculate the tensor
            product, because we can rewrite $k[T, U]/(TU - 1) = k[T, T^{-1}]$,
            so this is just a localization of $k[T]$. Morphism of spectrums,
            induced by inclusion into localization, is an open immersion, so
            fibers will be singletons if $x \in D(T)$ and empty sets otherwise.
            And the structure sheaf is also clear, it is just the restriction of
            structure sheaf $\mathcal{O}_{\Spec(k[T])}$.}
        \item{}
        \item{}
        \item{}
    \end{enumerate}
\end{exercise}

\begin{exercise}{4}
    Take $U = D(f)$ for some $f \in A$ and let $U = \cup_i D(f_i)$ be some
    cover. We have to check that 
    \begin{equation*}
        M[f^{-1}] \rightarrow \Eq\left[ \prod_i M[f^{-1}_i] \rightrightarrows
        \prod_{i, j} M[(f_i f_j)^{-1}]  \right]
    \end{equation*}
    is isomorphism.

    This proof is exactly the same as when we proved that
    $\mathcal{O}_{\Spec(A)}$ is a sheaf, after we defined it the basis of
    principal opens.

    Then proved that $A = \Eq\left[ \prod_i A[f^{-1}_i] \rightrightarrows
    \prod_{i, j} A[(f_i f_j)^{-1}]  \right]$ where $\Spec(A) = \cup_i
    D(f_i)$ is a cover.

\end{exercise}

\end{document}
