\newcommand{\sheet}{6}
\input{Header.tex}

\begin{document}

\maketitle{}

\begin{exercise}{1}
    \begin{enumerate}
    \item{
            Let $U \subseteq X$, $V \subseteq Y$ and $W \subseteq S$ open
            subschemes. By the universal property of the fiber product of
            locally ringed spaces, we have the following commutative diagram
            \begin{center}
                \begin{tikzcd}
                    &U\times_W V \arrow[dotted]{dr} \arrow{d}{p} \arrow{r}{q} &V
                    \arrow[hook]{dr} \\
                    &U \arrow[hook]{dr} &X \times_S Y
                    \arrow{r}{\pi_2}\arrow{d}{\pi_1} &Y \arrow{d}{\psi}\\
                    &&X \arrow{r}{\phi} &S
                \end{tikzcd}
            \end{center}
            so we get a unique map
            $U \times_W V \rightarrow X \times_S Y$.

            Observe the concrete space $\pi^{-1}_1(U) \cap \pi^{-1}_2(V)$ with
            inclusion
            \begin{equation*}
                \pi^{-1}_1(U) \cap \pi^{-1}_2(V) \hookrightarrow X \times_S Y
            \end{equation*}
            also satisfies the universal property of being a fibred product
            $U \times_S V$. If $T \to U$ and $T \to V$ such that
            $T \to U \to W = T \to V \to W$, then
            we can create the following diagram
            \begin{center}
                \begin{tikzcd}
                    &T \arrow[dotted]{dr} \arrow{d}{p} \arrow{r}{q} &V
                    \arrow[hook]{dr} \\
                    &U \arrow[hook]{dr} &X \times_S Y
                    \arrow{r}{\pi_2}\arrow{d}{\pi_1} &Y \arrow{d}{\psi}\\
                    &&X \arrow{r}{\phi} &S
                \end{tikzcd}
            \end{center}
            from which we get a unique map $T \to X \times_S Y$. Since its image
            is contained in $\pi^{-1}_1(U) \cap \pi^{-1}_2(V)$, it factors
            uniquely through
            \begin{equation*}
                T \to \pi^{-1}_1(U) \cap \pi^{-1}_2(V) \hookrightarrow X
                \times_S Y
            \end{equation*}

            % also $T \to U \to X \to S = T
            % \to V \to Y \to S$. So by the universal property of fibred product
            % $X \times_S Y$ we get a unique map $T \to X \times_S Y$. Since $T
            % \to U \to X = T \to X \times_S \to X$ and same for $Y$, the image
            % of $T \to X \times_S Y$ is contained in $\pi^{-1}_1(U) \cap
            % \pi^{-1}_2(V)$.

            Therefore, the fibre product $U \times_W V$ can be identified as an
            open subspace $\pi^{-1}_1(U) \cap \pi^{-1}_2(V) \subseteq X \times_S
            Y$.

            Then clearly for coverings $X = \cup_i U_i$, $Y = \cup_i V_i$ and $S =
            \cup_{i, j} S_{i, j}$, we have a covering
            \begin{equation*}
                \bigcup_{i, j} U_i \times_{S_{i, j}} V_j = \bigcup_{i, j}
                (\pi^{-1}_1(U_i) \cap \pi^{-1}_2(V_j)) = X \times_S Y.
            \end{equation*}

            I guess this is a good step in the direction of understanding why
            the pullback in the category of schemes exists, right? If we assume
            $X, Y, S$ to be schemes and $U_i, V_j, S_{i,j}$ to be affine
            schemes, then by the above argument we found a cover of $X\times_S
            Y$ by affine schemes.
            }
        \item{
            We use the previous exercise. Let $X = \bigcup_i U_i = \Spec(A_i)$,
            $Y = \bigcup_i V_i = \Spec(B_i)$ and $S = \bigcup_{i, j} S_{i, j} =
            \Spec(R_{i, j})$ be coverings with affine schemes.

            By the previous exercise we get a covering $\bigcup_{i, j} \Spec(A_i
            \otimes_{R_{i, j}} B_j)$ with affine schemes.
            
            The maps $\Spec(A_i \otimes_{R_{i, j}} B_j) \to |\Spec(A_i)|
            \times_{|\Spec(R_{i, j})|} |\Spec(B_j)|$ are surjective for every
            $i, j$, and we have
            \begin{equation*}
                |X| \times_{|S|} |Y| = \bigcup_{i, j} |\Spec(A_i)|
                \times_{|\Spec(R_{i, j})|} |\Spec(B_j)|
            \end{equation*}
            which proves surjectivity.

            We now want to show that the given map is not injective in general,
            not even for affine schemes. To see this, define the following
            affine schemes
            \begin{align*}
                X=Y=\Spec(\mathbb{C}), S=\Spec(\mathbb{R}).
            \end{align*}
            Now $| \Spec(X\times_S Y)| \cong | \Spec(X\otimes_S Y)| \cong
            |\Spec(\mathbb{C}\times \mathbb{C})|=\lbrace(0,1),(1,0)\rbrace.$

            On the other hand, $| X | \times_{| S |} | Y |=\lbrace * \rbrace$
            and clearly there is no injection from a set consisting of two
            points, to a set consisting of one point.
            }
    \end{enumerate}
\end{exercise}

\begin{exercise}{2}
    \begin{enumerate}
        \item{
            First let $f \colon X \rightarrow S$ be open immersion. In this case
            we can directly use previous exercise on the following fibred
            product
                      
        \begin{center}
            \begin{tikzcd}
                &S \arrow{r}{\id} &S \\
                &S \times_S S' \arrow{r}{q} \arrow{u}{p} &S' \arrow{u}{g}
            \end{tikzcd}
        \end{center}
        
            by taking subset of $X \subseteq S$ and immediately getting open
            immersion $X \times_S S' \rightarrow S \times_S S'$, which we
            postcompose with canonical isomorphism $S \times_S S' \rightarrow
            S'$ and get that $X \times_S S' \rightarrow S'$ is open immersion.

            Now suppose $f \colon X \rightarrow S$ is a closed immersion. So we
            have the following diagram

            \begin{center}
            \begin{tikzcd}
                &X \arrow{r}{f} &S \\
                &X \times_S S' \arrow{r}{q} \arrow{u}{p} &S' \arrow{u}{g}
            \end{tikzcd}
            \end{center}

            We want to show $X \times_S S' \rightarrow S'$ is also a closed
            immersion. For that it satisfies to find an open covering of $S'$
            with affine subschemes such that preimages with be also affine schemes
            and induced maps of rings surjective.

            Take $s \in S'$ and a neighborhood $g(s) \in \Spec(R) = U \subseteq
            S$. Preimage $f^{-1}(U) = \Spec(A)$ already is affine, since $f$ is
            closed immersion, and for $g^{-1}(U)$ we have to take some smaller
            affine neighborhood of $s$. So we get $s \in \Spec(B) \subseteq
            g^{-1}(U)$. Then use previous exercise on these open sets and obtain
            open immersion
            \begin{equation*}
                \Spec(A) \times_{\Spec(R)} \Spec(B) = \Spec(A \otimes_R B)
                \rightarrow X \times_S S'.
            \end{equation*}
            By remark at the start we have
            \begin{equation*}
                \Spec(A \otimes_R B) = p^{-1}(\Spec(A)) \cap q^{-1}(\Spec(B)) =
                q^{-1}(\Spec(B)).
            \end{equation*}
            Only thing to argue is why the map $B \rightarrow A \otimes_R B$ is
            surjective. Since $R \twoheadrightarrow A$ surjective, $R/I \cong A$
            and thus $A \otimes_R B = R/I \otimes_R B = B / IB$. Clearly $B
            \rightarrow B/IB$ is then surjective.
            }
        \item{
            }
    \end{enumerate}
\end{exercise}

\begin{exercise}{3}
    By definition we have to compute a fibred product of $\Spec(B) \to \Spec(A)$
    and $\Spec(k(p)) \to \Spec(A)$ (where $k(p)$ is the residue field of $p \in
    \Spec(A)$ and $\to$ is the canonical inclusion). Since we are dealing with
    affine schemes, we can express it concretely as $\Spec(B \otimes_A k(p))$.
    Note that $B$ has the structure of an $A$-algebra, which is induced
    by the starting morphism of schemes $\Spec(B) \rightarrow \Spec(A)$.
    So this exercise reduces to computing these tensor products.
    
    We also observe that $k[T]$ is a PID, which means every non-zero prime ideal
    is a maximal ideal. This will be handy when computing residue fields,
    because after quotienting with a non-zero ideal we already get a field (we do
    not have to further take the quotient field).

    \begin{enumerate}
        \item{In the first example we do now even have to calculate the tensor
            product, because we can rewrite $k[T, U]/(TU - 1) = k[T, T^{-1}]$,
            so this is just a localization of $k[T]$. Morphism of spectrums,
            induced by inclusion into localization, is an open immersion, so
            fibers will be singletons if $x \in D(T)$ and empty sets otherwise.
            And the structure sheaf is also clear, it is just the restriction of
            structure sheaf $\mathcal{O}_{\Spec(k[T])}$.}
        \item{}
        \item{}
        \item{}
    \end{enumerate}
\end{exercise}

\begin{exercise}{4}
    This proof is the same as when we proved that $\mathcal{O}_{\Spec(A)}$ is a
    sheaf, after we defined it on the basis of principal opens.

    Take $U = D(f)$ for some $f \in A$ and let $U = \cup_i D(f_i)$ be some
    cover. We have to check that 
    \begin{equation*}
        M[f^{-1}] \rightarrow \Eq\left[ \prod_i M[f^{-1}_i] \rightrightarrows
        \prod_{i, j} M[(f_i f_j)^{-1}]  \right]
    \end{equation*}
    is isomorphism.

    We make following simplifications, namely we can set $M := M[f^{-1}]$ and
    assume $I$ is finite, say $I = \{1, \dots, n\}$ (we can do that since
    $\Spec(A)$ is quasi-compact).

    So we are trying to show $M$ is isomorphic to a submodule of $\prod_i
    M[f^{-1}_i]$ defined as $\{ (m_1, \dots, m_n) \in \prod_i
    M[f^{-1}_i] \mid m_i = m_j \in M[(f_i f_j)^{-1}] \}$.

    Injectivity:
    Take $m \in M$. Since $m = 0 \in M[f^{-1}_i]$, we have $f^{k_i}_i m = 0$ for
    every $i$ for some $k_i$. Since $I$ is finite, take $k = \max_i k_i$.
    Since $D(f^k_i)$ is still a cover, we have $1 = \sum_i a_i f^k_i$ for some
    $a_i \in A$. Then $1m = \sum_i a_i f^k_i m = 0$, so $m = 0$.

    Surjectivity:
    Let $(m_1, \dots, m_n) \in \prod_i M[f^{-1}_i]$ with $m_i = m_j \in M[(f_i
    f_j)^{-1}]$ for all $i, j$. Write $m_i = \frac{a_i}{f^{k_i}_i}$. WLOG $k =
    \max_i k_i$. For every pair there exists $l \in \N$ such that $(f_i f_j)^l
    (m_i - m_j) = 0$. Take $l$ again to be maximum over all pairs. Because
    $D(f^l_i)$ is still a cover, we have $1 = \sum_i b_i f^l_i$. Then define $s
    = \sum_i b_i a_i$. Clearly $f^l_j s = \sum_i b_i f^l_j a_i =  \sum_i b_i
    f^l_i a_j = a_j$. So $(m_1, \dots, m_n)$ is the image of $s$.
\end{exercise}

\end{document}
